import e from"platform";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function t(e,t,n,i){return new(n||(n=Promise))((function(s,o){function r(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){e.done?s(e.value):new n((function(t){t(e.value)})).then(r,a)}l((i=i.apply(e,t||[])).next())}))}function n(e,t){var n,i,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=2&o[0]?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],i=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var i={axis:null,easing:"cubic-bezier(.03, .98, .52, .99)",exclude:null,gyroscope:!0,gyroscopeMinAngleX:45,gyroscopeMaxAngleX:45,gyroscopeMinAngleY:45,gyroscopeMaxAngleY:45,gyroscopeSamples:0,listener:window,max:15,perspective:1e3,"parallax-children-shine":!1,"parallax-children-disable":!1,"parallax-children-invert":!1,reset:!0,reverse:!1,scale:1,shine:!1,"max-shine":45,"shine-opacity":0,"shine-prerender":!1,"shine-save":!1,speed:300,startX:0,startY:0},s=function(){function s(e,t,n){var i=this;void 0===t&&(t={}),void 0===n&&(n={}),this.onDeviceOrientation=function(e){i.event=e,i.update(),i.updateElementPosition(),i.setTransition(),"function"==typeof i.callbacks.onDeviceOrientation&&i.callbacks.onDeviceOrientation(i.element)},this.onMouseEnter=function(){i.updateElementPosition(),i.setTransition(),"function"==typeof i.callbacks.onMouseEnter&&i.callbacks.onMouseEnter(i.element)},this.onMouseMove=function(e){null!==i.updateCall&&cancelAnimationFrame(i.updateCall),i.event=e,i.updateElementPosition(),i.updateCall=requestAnimationFrame((function(){return i.update()})),"function"==typeof i.callbacks.onMouseMove&&i.callbacks.onMouseMove(i.element)},this.onMouseLeave=function(){i.setTransition(),requestAnimationFrame((function(){return i.reset()})),"function"==typeof i.callbacks.onMouseLeave&&i.callbacks.onMouseLeave(i.element)},this.element=e,this.settings=this.extendSettings(t),this.callbacks=n,"function"==typeof this.callbacks.onInit&&this.callbacks.onInit(this.element),this.reverse=this.settings.reverse?-1:1,this.settings.shine&&this.prepareShine(),this.addEventListeners()}return s.prototype.enableMovementAccess=function(){return t(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,window.DeviceMotionEvent.requestPermission()];case 1:return[2,e.sent()]}}))}))},s.prototype.getElementListener=function(){if("string"==typeof this.settings.listener){var e=document.querySelector(this.settings.listener);if(e)return e}else if(this.settings.listener instanceof HTMLElement||this.settings.listener instanceof Window)return this.settings.listener},s.prototype.addEventListeners=function(){return t(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return this.listener=this.getElementListener(),function(t){var n,i;return(null===(n=e.name)||void 0===n?void 0:n.match(t))||(null===(i=e.product)||void 0===i?void 0:i.match(t))}(this.settings.exclude)?[3,3]:window.DeviceMotionEvent&&"ontouchstart"in document.documentElement&&this.settings.gyroscope?[4,this.enableMovementAccess()]:[3,2];case 1:return"granted"===t.sent()&&window.addEventListener("deviceorientation",this.onDeviceOrientation),[3,3];case 2:this.listener.addEventListener("mouseenter",this.onMouseEnter),this.listener.addEventListener("mousemove",this.onMouseMove),this.listener.addEventListener("mouseleave",this.onMouseLeave),t.label=3;case 3:return[2]}}))}))},s.prototype.removeEventListeners=function(){this.listener.removeEventListener("mouseenter",this.onMouseEnter),this.listener.removeEventListener("mousemove",this.onMouseMove),this.listener.removeEventListener("mouseleave",this.onMouseLeave),this.settings.gyroscope&&window.removeEventListener("deviceorientation",this.onDeviceOrientation)},s.prototype.destroy=function(){clearTimeout(this.timeout),null!==this.updateCall&&cancelAnimationFrame(this.updateCall),"function"==typeof this.callbacks.onDestroy&&this.callbacks.onDestroy(this.element),this.reset(),this.removeEventListeners(),this.element.universalTilt=null,delete this.element.universalTilt},s.prototype.reset=function(){this.event={pageX:this.left+this.width/2,pageY:this.top+this.height/2};var e="perspective("+this.settings.perspective+"px)",t="rotateX("+this.settings.startX+"deg)",n="rotateY("+this.settings.startY+"deg)";this.settings.reset&&(this.element.style.transform=e+" "+t+" "+n+" scale3d(1, 1, 1)"),this.resetShine()},s.prototype.resetShine=function(){this.settings.shine&&!this.settings["shine-save"]&&Object.assign(this.shineElement.style,{transform:"rotate(180deg) translate3d(-50%, -50%, 0)",opacity:0})},s.prototype.updateInitialPosition=function(){0===this.settings.startX&&0===this.settings.startY||this.onMouseEnter()},s.prototype.getValues=function(){var e,t;return e=this.event.clientX/this.element.clientWidth,t=this.event.clientY/this.element.clientHeight,e=Math.min(Math.max(e,0),1),t=Math.min(Math.max(t,0),1),{tiltX:(this.reverse*(this.settings.max/2-e*this.settings.max)).toFixed(2),tiltY:(this.reverse*(t*this.settings.max-this.settings.max/2)).toFixed(2),percentageX:100*e,percentageY:100*t,angle:Math.atan2(e-.5,.5-t)*(180/Math.PI)}},s.prototype.updateElementPosition=function(){if(this.width=this.listener instanceof Window?this.listener.innerWidth:this.listener.offsetWidth,this.height=this.listener instanceof Window?this.listener.innerWidth:this.listener.offsetHeight,this.listener instanceof HTMLElement){var e=this.listener.getBoundingClientRect();this.left=e.left,this.top=e.top}else this.left=0,this.top=0},s.prototype.update=function(){var e,t,n=this.getValues(),i="perspective("+this.settings.perspective+"px)",s="rotateX("+("X"===(null===(e=this.settings.axis)||void 0===e?void 0:e.toUpperCase())?0:n.tiltY)+"deg)",o="rotateY("+("Y"===(null===(t=this.settings.axis)||void 0===t?void 0:t.toUpperCase())?0:n.tiltX)+"deg)",r="scale3d("+this.settings.scale+", "+this.settings.scale+", "+this.settings.scale+")";this.element.style.transform=i+" "+s+" "+o+" "+r,this.settings.shine&&Object.assign(this.shineElement.style,{transform:"rotate("+n.angle+"deg) translate3d(-50%, -50%, 0)",opacity:""+this.settings["shine-opacity"]}),this.element.dispatchEvent(new CustomEvent("tiltChange",{detail:n})),this.updateCall=null},s.prototype.setValues=function(e,t){this.x=e,this.y=t},s.prototype.prepareShine=function(){if(!this.settings["shine-prerender"]){var e=document.createElement("div"),t=document.createElement("div");e.classList.add("shine"),t.classList.add("shine-inner"),e.appendChild(t),this.element.appendChild(e)}this.shineWrapper=this.element.querySelector(".shine"),this.shineElement=this.element.querySelector(".shine-inner"),this.settings["shine-prerender"]||(Object.assign(this.shineWrapper.style,{position:"absolute",top:"0",left:"0",height:"100%",width:"100%",overflow:"hidden"}),Object.assign(this.shineElement.style,{position:"absolute",top:"50%",left:"50%",pointerEvents:"none",backgroundImage:"radial-gradient(circle at top center, rgba(252, 253, 255, 1) 20%, rgba(255, 255, 255, 0) 60%)",width:2*this.element.offsetWidth+"px",height:2*this.element.offsetWidth+"px",transform:"rotate(180deg) translate3d(-50%, -50%, 0)",transformOrigin:"0% 0%",opacity:"0"}))},s.prototype.setTransition=function(){var e=this;clearTimeout(this.timeout),this.element.style.transition=this.settings.speed+"ms "+this.settings.easing,this.settings.shine&&(this.shineElement.style.transition="opacity "+this.settings.speed+"ms "+this.settings.easing),this.timeout=setTimeout((function(){e.element.style.transition="",e.settings.shine&&(e.shineElement.style.transition="")}),this.settings.speed)},s.prototype.extendSettings=function(e){var t,n={};for(t in i)if(t in e)n[t]=e[t];else if(this.element.getAttribute("data-tilt-"+t)){var s=this.element.getAttribute("data-tilt-"+t);try{n[t]=JSON.parse(s)}catch(e){n[t]=s}}else n[t]=i[t];return n},s.init=function(e){void 0===e&&(e={});var t=e.elements,n=e.settings,i=e.callbacks;if(t instanceof Node&&(t=[t]),t instanceof NodeList&&(t=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),s=0;for(t=0;t<n;t++)for(var o=arguments[t],r=0,a=o.length;r<a;r++,s++)i[s]=o[r];return i}(t)),t instanceof Array)for(var o=0,r=t;o<r.length;o++){var a=r[o];if(!("universalTilt"in a))return a.universalTilt=new s(a,n,i)}},s}();if("undefined"!=typeof document){window.UniversalTilt=s;var o=document.querySelectorAll("[data-tilt]");o.length&&s.init({elements:o})}window.jQuery&&(window.jQuery.fn.universalTilt=function(e){return void 0===e&&(e={}),s.init({elements:this,settings:e.settings||{},callbacks:e.callbacks||{}})});export default s;
//# sourceMappingURL=universal-tilt.esm.js.map
